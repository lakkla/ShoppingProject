import{_ as g,u as _,i as U,r as i,j as w,o as d,c as m,g as V,d as t,t as q,w as x,e as r,v as n,z as p,m as k}from"./index-ecdd9460.js";import{A as E}from"./AdminSidebar-38f02eac.js";import{a as u}from"./index-dd35b931.js";const M={class:"admin-layout"},S={class:"main-content"},A={class:"page-header"},B={class:"page-title"},C={class:"form-card"},N={class:"form-group"},R=["disabled"],D={class:"form-group"},I={class:"form-group"},P={class:"form-group"},$={class:"form-group"},j={class:"form-group"},z={class:"form-actions"},L={__name:"UserEdit",setup(T){const v=_(),f=U(),l=i(f.query.id||null),s=i({username:"",name:"",phone:"",email:"",role:0,status:1}),b=async()=>{if(l.value)try{const o=await u.userList();if(o.code===200){const e=o.data.find(a=>a.id==l.value);e&&(s.value={username:e.username,name:e.name,phone:e.phone,email:e.email,role:e.role,status:e.status})}}catch(o){console.error("加载用户信息失败",o)}},y=async()=>{try{const o={...s.value,id:l.value},e=await u.userUpdate(o);e.code===200?(alert(e.message),v.push("/admin/user/list")):alert(e.message)}catch{alert("保存失败")}},c=async()=>{if(confirm("确定要重置该用户密码为123456吗？"))try{const o=await u.userResetPassword(l.value);o.code,alert(o.message)}catch{alert("重置失败")}};return w(()=>{b()}),(o,e)=>(d(),m("div",M,[V(E),t("div",S,[t("div",A,[t("h2",B,q(l.value?"编辑用户":"添加用户"),1)]),t("div",C,[t("form",{onSubmit:x(y,["prevent"])},[t("div",N,[e[7]||(e[7]=t("label",null,"用户名",-1)),r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.username=a),type:"text",disabled:!!l.value,required:""},null,8,R),[[n,s.value.username]])]),t("div",D,[e[8]||(e[8]=t("label",null,"姓名",-1)),r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.name=a),type:"text",required:""},null,512),[[n,s.value.name]])]),t("div",I,[e[9]||(e[9]=t("label",null,"手机号",-1)),r(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.phone=a),type:"text",required:""},null,512),[[n,s.value.phone]])]),t("div",P,[e[10]||(e[10]=t("label",null,"邮箱",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.email=a),type:"email",required:""},null,512),[[n,s.value.email]])]),t("div",$,[e[12]||(e[12]=t("label",null,"角色",-1)),r(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>s.value.role=a),required:""},[...e[11]||(e[11]=[t("option",{value:0},"普通用户",-1),t("option",{value:1},"管理员",-1)])],512),[[p,s.value.role,void 0,{number:!0}]])]),t("div",j,[e[14]||(e[14]=t("label",null,"状态",-1)),r(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>s.value.status=a),required:""},[...e[13]||(e[13]=[t("option",{value:1},"启用",-1),t("option",{value:0},"禁用",-1)])],512),[[p,s.value.status,void 0,{number:!0}]])]),t("div",z,[e[15]||(e[15]=t("button",{type:"submit",class:"btn btn-primary"},"保存",-1)),t("button",{type:"button",class:"btn btn-secondary",onClick:e[6]||(e[6]=a=>o.$router.back())},"取消"),l.value?(d(),m("button",{key:0,type:"button",class:"btn btn-warning",onClick:c},"重置密码")):k("",!0)])],32)])])]))}},J=g(L,[["__scopeId","data-v-eab6e16f"]]);export{J as default};
