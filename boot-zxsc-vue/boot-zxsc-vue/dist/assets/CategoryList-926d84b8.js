import{_ as h,r,j as D,o as i,c as d,g as w,d as e,F as x,l as L,w as p,t as u,e as A,v as N,m as S}from"./index-ecdd9460.js";import{A as V}from"./AdminSidebar-38f02eac.js";import{a as v}from"./index-dd35b931.js";const B={class:"admin-layout"},F={class:"main-content"},M=["onClick"],E=["onClick"],I={class:"form-group"},T={__name:"CategoryList",setup($){const g=r([]),o=r(!1),l=r(null),s=r({name:""}),c=async()=>{try{const a=await v.categoryList();a.code===200&&(g.value=a.data)}catch(a){console.error("加载分类列表失败",a)}},b=a=>a?new Date(a).toLocaleDateString("zh-CN"):"",f=()=>{l.value=null,s.value={name:""},o.value=!0},y=a=>{l.value=a,s.value={name:a.name},o.value=!0},m=()=>{o.value=!1,l.value=null,s.value={name:""}},_=async()=>{var a;try{const t={name:s.value.name,id:(a=l.value)==null?void 0:a.id},n=await v.categorySave(t);n.code===200?(alert(n.message),m(),c()):alert(n.message)}catch{alert("保存失败")}},C=async a=>{if(confirm("确定要删除该分类吗？"))try{const t=await v.categoryDelete(a);t.code===200?(alert(t.message),c()):alert(t.message)}catch{alert("删除失败")}};return D(()=>{c()}),(a,t)=>(i(),d("div",B,[w(V),e("div",F,[e("div",{class:"page-header"},[t[2]||(t[2]=e("h2",{class:"page-title"},"分类管理",-1)),e("button",{class:"btn-add",onClick:f},"添加分类")]),e("table",null,[t[3]||(t[3]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"分类名称"),e("th",null,"创建时间"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),d(x,null,L(g.value,n=>(i(),d("tr",{key:n.id},[e("td",null,u(n.id),1),e("td",null,u(n.name),1),e("td",null,u(b(n.createTime)),1),e("td",null,[e("button",{class:"btn btn-edit",onClick:k=>y(n)},"编辑",8,M),e("button",{class:"btn btn-delete",onClick:k=>C(n.id)},"删除",8,E)])]))),128))])]),o.value?(i(),d("div",{key:0,class:"dialog-overlay",onClick:m},[e("div",{class:"dialog-content",onClick:t[1]||(t[1]=p(()=>{},["stop"]))},[e("h3",null,u(l.value?"编辑分类":"添加分类"),1),e("form",{onSubmit:p(_,["prevent"])},[e("div",I,[t[4]||(t[4]=e("label",null,"分类名称",-1)),A(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>s.value.name=n),type:"text",required:""},null,512),[[N,s.value.name]])]),e("div",{class:"dialog-actions"},[t[5]||(t[5]=e("button",{type:"submit",class:"btn btn-primary"},"保存",-1)),e("button",{type:"button",class:"btn btn-secondary",onClick:m},"取消")])],32)])])):S("",!0)])]))}},U=h(T,[["__scopeId","data-v-88fc19bf"]]);export{U as default};
