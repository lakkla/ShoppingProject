import{_ as y,u as g,a as U,r as i,j as V,o as x,c as _,g as q,d as s,n as p,e as n,s as m,w as v,v as u}from"./index-ecdd9460.js";import{H as c}from"./Header-0f98523e.js";import{u as w}from"./index-dd35b931.js";const D={class:"container"},S={class:"profile-card"},k={class:"tab-header"},F={class:"tab-content"},B={class:"form-group"},C={class:"form-group"},I={class:"form-group"},M={class:"form-group"},H={class:"tab-content"},N={class:"form-group"},T={class:"form-group"},$={class:"form-group"},j={__name:"Profile",setup(z){g();const r=U(),d=i("info"),o=i({username:"",name:"",phone:"",email:""}),l=i({oldPassword:"",newPassword:"",confirmPassword:""}),f=()=>{r.user&&(o.value={username:r.user.username,name:r.user.name,phone:r.user.phone,email:r.user.email})},b=async()=>{try{const t=new FormData;t.append("name",o.value.name),t.append("phone",o.value.phone),t.append("email",o.value.email);const e=await w.update(t);e.code===200?(alert(e.message),r.setUser({...r.user,name:o.value.name,phone:o.value.phone,email:o.value.email})):alert(e.message)}catch{alert("更新失败")}},P=async()=>{if(l.value.newPassword!==l.value.confirmPassword){alert("两次密码输入不一致");return}try{const t=new FormData;t.append("oldPassword",l.value.oldPassword),t.append("newPassword",l.value.newPassword);const e=await w.updatePassword(t);e.code===200?(alert(e.message),l.value={oldPassword:"",newPassword:"",confirmPassword:""}):alert(e.message)}catch{alert("修改失败")}};return V(()=>{f()}),(t,e)=>(x(),_("div",null,[q(c),s("div",D,[e[18]||(e[18]=s("h2",{class:"page-title"},"个人信息",-1)),s("div",S,[s("div",k,[s("button",{class:p({active:d.value==="info"}),onClick:e[0]||(e[0]=a=>d.value="info")},"基本信息",2),s("button",{class:p({active:d.value==="password"}),onClick:e[1]||(e[1]=a=>d.value="password")},"修改密码",2)]),n(s("div",F,[s("form",{onSubmit:v(b,["prevent"])},[s("div",B,[e[9]||(e[9]=s("label",null,"用户名",-1)),n(s("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.username=a),type:"text",disabled:""},null,512),[[u,o.value.username]])]),s("div",C,[e[10]||(e[10]=s("label",null,"姓名",-1)),n(s("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.name=a),type:"text",required:""},null,512),[[u,o.value.name]])]),s("div",I,[e[11]||(e[11]=s("label",null,"手机号",-1)),n(s("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.phone=a),type:"text",required:""},null,512),[[u,o.value.phone]])]),s("div",M,[e[12]||(e[12]=s("label",null,"邮箱",-1)),n(s("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.email=a),type:"email",required:""},null,512),[[u,o.value.email]])]),e[13]||(e[13]=s("button",{type:"submit",class:"btn btn-primary"},"保存修改",-1))],32)],512),[[m,d.value==="info"]]),n(s("div",H,[s("form",{onSubmit:v(P,["prevent"])},[s("div",N,[e[14]||(e[14]=s("label",null,"原密码",-1)),n(s("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>l.value.oldPassword=a),type:"password",required:""},null,512),[[u,l.value.oldPassword]])]),s("div",T,[e[15]||(e[15]=s("label",null,"新密码",-1)),n(s("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.newPassword=a),type:"password",required:""},null,512),[[u,l.value.newPassword]])]),s("div",$,[e[16]||(e[16]=s("label",null,"确认新密码",-1)),n(s("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.confirmPassword=a),type:"password",required:""},null,512),[[u,l.value.confirmPassword]])]),e[17]||(e[17]=s("button",{type:"submit",class:"btn btn-primary"},"修改密码",-1))],32)],512),[[m,d.value==="password"]])])])]))}},G=y(j,[["__scopeId","data-v-6bc20ae9"]]);export{G as default};
