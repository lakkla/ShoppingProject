import{_ as q,u as D,i as $,r as l,j as b,o,c,g as L,d as t,e as B,v as F,k as T,n as g,F as h,l as f,t as d}from"./index-ecdd9460.js";import{H as V}from"./Header-0f98523e.js";import{p as C,c as A}from"./index-dd35b931.js";const H={class:"search-bar"},K={class:"container"},M={class:"category-list"},N=["onClick"],R={class:"product-grid"},j=["onClick"],z=["src","alt"],E={key:1,class:"no-image"},P={class:"product-info"},S={class:"product-name"},U={class:"product-price"},G={class:"product-stock"},J=["onClick"],O={__name:"List",setup(Q){const _=D(),i=$(),v=l([]),p=l([]),n=l(""),r=l(null),u=async()=>{try{const s={};r.value&&(s.categoryId=r.value),n.value&&(s.keyword=n.value);const a=await C.list(s);a.code===200&&(v.value=a.data)}catch(s){console.error("加载商品失败",s)}},w=async()=>{try{const s=await C.categories();s.code===200&&(p.value=s.data)}catch(s){console.error("加载分类失败",s)}},y=s=>{r.value=s,u()},m=()=>{u()},I=s=>{_.push(`/product/detail/${s}`)},x=async s=>{try{const a=new FormData;a.append("productId",s),a.append("quantity",1);const e=await A.add(a);e.code,alert(e.message)}catch{alert("请先登录"),_.push("/login")}};return b(()=>{i.query.categoryId&&(r.value=parseInt(i.query.categoryId)),i.query.keyword&&(n.value=i.query.keyword),w(),u()}),(s,a)=>(o(),c("div",null,[L(V),t("div",H,[B(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),type:"text",placeholder:"搜索商品...",onKeyup:T(m,["enter"])},null,544),[[F,n.value]]),t("button",{onClick:m},"搜索")]),t("div",K,[t("div",M,[t("a",{onClick:a[1]||(a[1]=e=>y(null)),class:g({active:!r.value})},"全部",2),(o(!0),c(h,null,f(p.value,e=>(o(),c("a",{key:e.id,onClick:k=>y(e.id),class:g({active:r.value===e.id})},d(e.name),11,N))),128))]),t("div",R,[(o(!0),c(h,null,f(v.value,e=>(o(),c("div",{class:"product-card",key:e.id},[t("div",{class:"product-image",onClick:k=>I(e.id)},[e.image?(o(),c("img",{key:0,src:e.image,alt:e.name},null,8,z)):(o(),c("div",E,"暂无图片"))],8,j),t("div",P,[t("div",S,d(e.name),1),t("div",U,"¥"+d(e.price),1),t("div",G,"库存："+d(e.stock),1),t("button",{class:"btn-cart",onClick:k=>x(e.id)},"加入购物车",8,J)])]))),128))])])]))}},Z=q(O,[["__scopeId","data-v-a28642c7"]]);export{Z as default};
